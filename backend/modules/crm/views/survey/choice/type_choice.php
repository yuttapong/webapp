<?phpuse yii\helpers\Html;use backend\modules\qtn\models\Question;$required = '';if (count($modelQuestion->questionChoices) > 0) {    $required = $modelQuestion->required == 'Y' ? ' reqquired' : '';    $i = 1;    //$seq = $title_hide ==1 ? $modelQuestion->seq.') ':'';    echo '<div class="row">';    echo '<h4>' . $modelQuestion->seq . ') ' . $modelQuestion->name . '</h4>';    echo html::beginTag('pre',['class' => '']);    // แสดงปุ่มเคลียร์คำตอบของหัวข้อในหน้าแก้ไข    if(Yii::$app->controller->action->id == 'update'){        if(Question::TYPE_RADIO == $modelQuestion->type_id){            echo'<div class="col-xs-12">';            echo Html::button('เคลียร์คำตอบ',[                'class'=>'q-clear-radio btn btn-xs btn-warning',                'data-qid'=>$modelQuestion->id,                'data-qname' => $modelQuestion->name,                'data-qtype'=>$modelQuestion->type_id,                'data-responseid' => $modelResponse->id,                'data-qname' => $modelQuestion->name,            ]);            echo'</div>';        }    }    foreach ($modelQuestion->questionChoices as $val) {        // hidden if the choice is "Inactive", but it will still  save  in background when update data.        $hiddenChoice = ($val->active===1)?'show':'hidden';        echo '<div class="col-xs-12 col-sm-4 col-md-4 form-inline '.$hiddenChoice.'">';        $other = '';        switch ($modelQuestion->type_id) {            case Question::TYPE_RADIO:                $checkedRadio = (in_array($val->id, $answerSingle)) ? true : false;                $others = $modelResponse->getAnswerOthers($modelQuestion->id, $val->id);                if (count($others) > 0) {                    $checkedRadio = true;                    $other = Html::ul($others, ['class' => 'nav-list']);                }                echo Html::radio("radio[{$modelQuestion->id}]", $checkedRadio, [                    'value' => $val->id,                    'id' => 'choice-' . $val->id,                    'class' => 'choice-radio',                ]);                echo '&nbsp;';                echo Html::label($val->content);                if ($val->type == 'another') {                    if (Yii::$app->controller->action->id == 'update'):                        echo '&nbsp;' . Html::a('<i class="fa fa-edit"></i>', 'javascript:void(0)', [                                'data-survey' => $modelQuestion->survey_id,                                'data-question' => $modelQuestion->id,                                'data-choice' => $val->id,                                'data-response' => $responseId,                                'data-title' => $val->content,                                'class' => 'do-others',                            ]);                    endif;                    echo Html::tag('span', $other, ['id' => 'show-others-' . $val->id]);                }                break;            case Question::TYPE_CHECKBOX :                $checkedCheckbox = (in_array($val->id, $answerMultiple)) ? true : false;                $others = $modelResponse->getAnswerOthers($modelQuestion->id, $val->id);                if (count($others) > 0) {                    $checkedCheckbox = true;                    $other = Html::ul($others, ['class' => 'nav-list']);                }                echo Html::checkbox("checkbox[{$modelQuestion->id}][{$val->id}]", $checkedCheckbox, [                    'value' => $val->id,                    'id' => 'choice-' . $val->id,                ]);                echo '&nbsp;';                echo Html::label($val->content);                if ($val->type == 'another') {                    if (Yii::$app->controller->action->id == 'update'):                        // show [button]  when action is update                        echo '&nbsp;' . Html::a('<i class="fa fa-edit"></i>', 'javascript:void(0)', [                                'data-survey' => $modelQuestion->survey_id,                                'data-question' => $modelQuestion->id,                                'data-choice' => $val->id,                                'data-response' => $responseId,                                'data-title' => $val->content,                                'class' => 'do-others',                            ]);                    endif;                    echo Html::tag('span', $other, ['id' => 'show-others-' . $val->id]);                }                break;        }        echo '</div>';        $i++;    }    echo Html::endTag('pre');    echo '</div>';}$script = <<< JS$('.do-others').on('click', function(e) {var surveyId = $(this).data('survey');var choiceId = $(this).data('choice');var responseId = $(this).data('response');var questionId = $(this).data('question');var target = $("#show-others-" +  choiceId);var header = $(this).data('title');    $.ajax({      type:'post',       url: 'form-others',       dataType:'html',       data: {surveyId: surveyId, choiceId: choiceId,responseId:responseId,questionId:questionId},       success: function(rs) {            $('#modall-view .modal-header').html('<h3 class="modal-title">' + header + '</h3>');            $('#modall-view .modal-body').html(rs);            $('#modall-view').modal({"show": true});       }    });});$('.q-clear-radio').on('click', function(e) {var qname = $(this).data('qname');var qid = $(this).data('qid');var responseid = $(this).data('responseid');var qtype = $(this).data('qtype');if(confirm('คุณต้องการลบคำตอบในข้อนี้ใช่หรือไม่ ?\\n หัวข้อ:: ' + qname)) {       $.ajax({       type:'post',       url: 'clear-answer-radio',       dataType:'json',       data:{           qid: qid,            qtype: qtype,           responseid: responseid       },       success: function(rs) {         console.log(qid);         $('[name="radio[' + qid + ']"]:checked').attr('checked',false);       }       })}})JS;$this->registerJs($script);?>